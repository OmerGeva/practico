<% link_to 'New challenge', new_challenge_path, class: 'btn btn-primary' %>
<div style="width: 200px">
  <%= form_tag account_path(current_user), method: :get do %>
  <%= text_field_tag :query,
  params[:query],
  class: "form-control",
    placeholder: "Enter Username"
    %>
    <% end %>
  </div>
  <div class="dashboard-container">
    <div class="col-4">

      <!-- USER INFO -->
      <div class="user-info">
        <%= cl_image_tag current_user.photo, alt: "user avatar", class: "avatar-large" %>
        <p><%= current_user.username %></p>
        <p><%= current_user.email %></p>
        <p>
          <%= current_user.first_name %>
          <%= current_user.last_name %>
        </p>
      </div>

      <!-- ACHIEVEMENTS -->
      <div class="achievements">
        <h4>Achievements</h4>

    </div>

    <!-- NOTIFICATIONS -->
    <div class="notifications">
      <h4>Notifications</h4>
      <h6>Finished Challenges:</h6>
      <% current_user.users_challenges.each do |users_challenge| %>
      <% if users_challenge.unread %>
      <p><%= users_challenge.challenge.skill.title %> has finished!</p> <%= link_to 'Check Challenge', challenge_finished_path(users_challenge.challenge), class: "btn btn-primary btn-sm"%>
      <% end %>
      <% end %>
      <h6>Friend Requests:</h6>
      <% current_user.requested_friends.each do |friend| %>
      <%= "#{friend.first_name.capitalize} #{friend.last_name.capitalize}"  %> <%= link_to "Accept", accept_friend_account_path(friend), method: :post, class: "btn btn-primary btn-sm" %>
      <% end %>
    </div>

  </div>

  <!-- CHALLENGES -->
  <% unless current_user.challenges.empty? %>
  <div class="col-8 challenges-index pl-0">
    <% @users_challenges.each do |user_challenge| %>

    <!-- CHALLENGE CARD -->
    <div class="challenge-card">
      <% challenge = user_challenge.challenge %>
      <% if user_challenge.accepted %>
      <p><%= link_to challenge.skill.title.capitalize, challenge_path(challenge) %></p>
      <% else %>
      <p><%= challenge.skill.title.capitalize %></p>
      <% end %>
      <% unless user_challenge.accepted %>
      <%= link_to "Accept", challenge_accept_path(challenge), method: :patch, class: 'btn btn-primary' %>
      <%= link_to "Decline", challenge_decline_path(challenge), method: :delete, class: 'btn btn-primary' %>
      <% end %>
      <p>Milestone: <%= challenge.milestone %></p>
      <p>Start Date: <%= challenge.starting_date.strftime('%B %e at %l:%M %p') %></p>
      <p><%= challenge.description %></p>
      <% if user_challenge.accepted %>
      <%= link_to "Check in", new_challenge_check_in_path(user_challenge.challenge), class: 'btn btn-secondary' %>
      <% end %>
    </div>
    <% end %>
  </div>

  <% else %>
  <div class="col-8 challenges-index pl-0">
    <div class="challenge-card">
      <h2 class="text-center">You have no challenges</h2>
      <div class="d-flex justify-content-center">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 300">
            <defs>
              <mask id="MASK" maskunits="userSpaceOnUse"
              maskcontentunits="userSpaceOnUse">
              <image xlink:href="https://media.giphy.com/media/3o85xyj0M45c9MkXhS/giphy.gif"
              height="100%"
              width="100%"/>
            </mask>
          </defs>

          <image mask="url(#MASK)" x="0" y="-20%" class="space" xlink:href="https://s3-us-west-2.amazonaws.com/s.cdpn.io/756881/space.jpg"
          height="198%" width="200%"/>
        </svg>
      </div>
      <div class="d-flex justify-content-around">
        <%= link_to "Make a new Challenge!", new_challenge_path, class: 'btn btn-primary'  %>
      </div>
    </div>
  </div>
  <% end %>
</div>


